<script type="module">
  import { PGlite } from "../dist/index.js";
  // import { PGlite } from "https://cdn.jsdelivr.net/npm/@electric-sql/pglite/dist/index.js";

  console.log("Starting...");
  // In-memory database:
  // const pg = new PGlite();
  // const pg = new PGlite({ debug: 1 });
  // Or with IndexedDB:
  const pg = new PGlite('idb://pgdata');

  console.log("Waiting for ready...");
  await pg.waitReady;

  console.log("Ready!");

  // // check pgvector
  // // install extension
  // await pg.exec("CREATE EXTENSION IF NOT EXISTS vector;");
  // // make table
  // await pg.exec(`
  //   CREATE TABLE IF NOT EXISTS test (
  //     id SERIAL PRIMARY KEY,
  //     name TEXT,
  //     vec vector(3)
  //   );
  // `);
  // // add three rows
  // await pg.exec("INSERT INTO test (name, vec) VALUES ('test1', '[1,2,3]');");
  // await pg.exec("INSERT INTO test (name, vec) VALUES ('test2', '[4,5,6]');");
  // await pg.exec("INSERT INTO test (name, vec) VALUES ('test3', '[7,8,9]');");
  // // select all rows
  // const res = await pg.exec(`
  //   SELECT * FROM test;
  // `);
  // console.log(res);
  // // test cosine similarity
  // const res2 = await pg.exec(`
  //   SELECT
  //     name,
  //     vec,
  //     vec <-> '[3,1,2]' AS distance
  //   FROM test;
  // `);
  // console.log(res2);

  // // check error
  // const ret = await pg.exec("SELECT * from test;");
  // console.log(ret);

  // // check version
  // const ret = await pg.exec("SELECT version();");
  // console.log(ret);

  // console.log("Creating table...");
  // await pg.exec(`
  //   CREATE TABLE IF NOT EXISTS test (
  //     id SERIAL PRIMARY KEY,
  //     name TEXT
  //   );
  // `);

  // console.log("Inserting data...");
  // await pg.exec("INSERT INTO test (name) VALUES ('test');");

  // console.log("Selecting data...");
  // const res = await pg.exec(`
  //   SELECT * FROM test;
  // `);

  // console.log(res);

  // const res2 = await pg.exec(`
  //   SELECT 1, 2, 3;
  // `);
  // console.log(res2);
</script>
